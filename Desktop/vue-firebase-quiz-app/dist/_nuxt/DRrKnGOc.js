import{_ as $}from"./BvovbkOQ.js";import{m as B,s as R,g as A,r as u,y as V,c as l,o as i,a as e,B as L,C as M,j as d,D as j,t as n,F as w,E as D,l as T,b as E}from"./DMWciSDP.js";import"./BQ1RNRjM.js";const U={class:"container mx-auto px-4 py-8"},Y={class:"max-w-6xl mx-auto"},P={class:"bg-white rounded-lg shadow-md p-6 mb-8"},q={class:"mb-6"},z={class:"flex space-x-2"},G=["disabled"],H={class:"overflow-x-auto"},I={class:"min-w-full table-auto"},J={class:"px-4 py-2"},K={class:"px-4 py-2"},O={class:"px-4 py-2"},Q=["onClick","disabled"],W={class:"bg-white rounded-lg shadow-md p-6"},X={class:"space-y-4"},Z={class:"flex justify-between items-start mb-2"},ee={class:"font-semibold text-gray-800"},te={class:"text-sm text-gray-600"},se={class:"bg-gray-50 rounded p-3"},ae={class:"text-sm overflow-x-auto"},oe={key:0,class:"text-center text-gray-600 py-8"},de={__name:"AdminDashboard",setup(k){const{getAllSubmissions:g,addAdmin:v,removeAdmin:p,getAllAdmins:b}=B(),{user:y}=R(A()),S=A(),x=u([]),f=u([]),r=u(""),_=u(!1),N=u(!0),h=async()=>{try{const[a,t]=await Promise.all([g(),b()]);x.value=a,f.value=t}catch(a){console.error("Error loading data:",a),alert("Failed to load dashboard data")}finally{N.value=!1}},F=async()=>{if(r.value){_.value=!0;try{await v(r.value),r.value="",await h(),alert("Admin added successfully!")}catch(a){console.error("Error adding admin:",a),alert("Failed to add admin")}finally{_.value=!1}}},C=async a=>{if(a===y.value.email){alert("You cannot remove yourself as admin");return}if(confirm(`Are you sure you want to remove ${a} as admin?`))try{await p(a),await h(),await S.refreshAdminStatus(),alert("Admin removed successfully!")}catch(t){console.error("Error removing admin:",t),alert("Failed to remove admin")}};return V(()=>{h()}),(a,t)=>(i(),l("div",U,[e("div",Y,[t[4]||(t[4]=e("h1",{class:"text-3xl font-bold text-gray-800 mb-8"},"Admin Dashboard",-1)),e("div",P,[t[2]||(t[2]=e("h2",{class:"text-2xl font-semibold text-gray-800 mb-4"},"Admin Management",-1)),e("div",q,[e("div",z,[L(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>j(r)?r.value=s:null),type:"email",placeholder:"Enter email to add as admin",class:"flex-1 border border-gray-300 rounded-md px-3 py-2"},null,512),[[M,d(r)]]),e("button",{onClick:F,disabled:!d(r)||d(_),class:"bg-green-500 hover:bg-green-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-md"},n(d(_)?"Adding...":"Add Admin"),9,G)])]),e("div",H,[e("table",I,[t[1]||(t[1]=e("thead",null,[e("tr",{class:"bg-gray-50"},[e("th",{class:"px-4 py-2 text-left"},"Email"),e("th",{class:"px-4 py-2 text-left"},"Added At"),e("th",{class:"px-4 py-2 text-left"},"Actions")])],-1)),e("tbody",null,[(i(!0),l(w,null,D(d(f),s=>{var o,c,m;return i(),l("tr",{key:s.email,class:"border-t"},[e("td",J,n(s.email),1),e("td",K,n(((m=(c=(o=s.addedAt)==null?void 0:o.toDate)==null?void 0:c.call(o))==null?void 0:m.toLocaleDateString())||"N/A"),1),e("td",O,[e("button",{onClick:ne=>C(s.email),disabled:s.email===d(y).email,class:"bg-red-500 hover:bg-red-700 disabled:bg-gray-400 text-white px-3 py-1 rounded text-sm"},n(s.email===d(y).email?"You":"Remove"),9,Q)])])}),128))])])])]),e("div",W,[t[3]||(t[3]=e("h2",{class:"text-2xl font-semibold text-gray-800 mb-4"},"User Submissions",-1)),e("div",X,[(i(!0),l(w,null,D(d(x),s=>{var o,c,m;return i(),l("div",{key:s.id,class:"border border-gray-200 rounded-lg p-4"},[e("div",Z,[e("div",null,[e("h3",ee,n(s.userEmail),1),e("p",te,n(((m=(c=(o=s.timestamp)==null?void 0:o.toDate)==null?void 0:c.call(o))==null?void 0:m.toLocaleString())||"No timestamp"),1)])]),e("div",se,[e("pre",ae,n(s.code),1)])])}),128)),d(x).length===0?(i(),l("div",oe," No submissions yet. ")):T("",!0)])])])]))}},re={class:"min-h-screen bg-gray-100"},me={__name:"index",setup(k){return(g,v)=>{const p=$,b=de;return i(),l("div",re,[E(p),E(b)])}}};export{me as default};
